# 第4章	第一个程序

## 4.1 一个源程序从写出到执行的过程

编写汇编源程序--对源程序进行编译连接--执行可执行文件中的程序



## 4.2 源程序

### 1） 伪指令

（1）伪指令

没有对应的机器指令，最终不被CPU所执行

（2）

段名	segment 

​				:

​				:

​				:

段名	ends

segment和ends的功能是定义一个段，segment说明一个段开始，ends说明一个段结束。

二者之间的指令是代码段。

（3）

end：一个汇编程序的结束标记，碰到该伪指令就结束对源程序的编译。

（4）

assume: 含义为“假设”。

它假设某一段寄存器和程序中的某一个用segment...ends定义的段相关联。

通过assume说明这种关联，在需要的情况下，编译程序可以将段寄存器和某一个具体的段相联系。

如 用assume cs:codesg将用作代码段的段codesg和CPU中的段寄存器cs联系起来

```
assume cs:codesg

codesg segment

	mov ax,0123H
	mov bx,0456H
	add ax,bx
	add ax,ax

	mov ax,4c00H
	int 21H

codeesg ends

end
```



### 2）源程序中的程序

源程序文件--编译连接--可执行文件

### 3）标号

除了汇编指令和伪指令外，还有一些标号，比如“cedesg”

一个标号指代了一个地址。

如codesg在segment前面，作为一个段的名称，最终被处理为一个段的段地址

### 4)程序的结构



### 5）程序返回

（1）程序返回：一个程序结束后，将CPU的控制权交还给使她得以运行的程序。

（2）如指令：

​	mov ax,4c00H

​	int 21H

这两条指令实现的功能就是程序返回。（由CPU执行）

### 6）语法和逻辑错误

程序在编译时被编译器发现的错误时语法错误；

在程序编译后，在运行时发生的错误是逻辑错误。



## 4.3 编辑源程序

进入dos，运行edit---在edit中编辑程序---保存文件退出edit



## 4.4编译

进入dos，运行masm。exe---输入文件名,按下enter---确定目标文件名称---.obj/.lst/.crf

## 4.5 连接

走一遍书内流程

## 4.6 以简化的方式进行编译和连接

link 文件名



##  4.7 1.exe的执行



## 4.8 谁将可执行文件的程序装载进内存并使它运行？

（1）任何通用的操作系统，都要提供一个称为shell（外壳）的程序，用户使用这个程序来操作计算机系统进行工作

（2）DOS中有一个 程序command.com,这个程序在DOS中称为命令解释器，也就是DOS系统的shell。

（3）如果用户要执行一个程序，则输入该程序的可执行文件的名称，command首先根据文件名找到可执行文件，然后将这个可执行文件中的程序加载入内存，设置CS:IP指向程序的入口。

此后，command暂停运行，CPU运行程序。程序运行结束后，返回到command中，command再次显示由当前盘符和路径组成的提示符，等待用户的输入。

（4）编程->1.asm->编译->1.obj->连接->1.exe->加载->内存中的程序->运行



## 4.9 程序执行过程的跟踪

debug 程序名.exe





